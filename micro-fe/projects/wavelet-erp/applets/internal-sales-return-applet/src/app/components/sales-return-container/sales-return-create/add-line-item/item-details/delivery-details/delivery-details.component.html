
<form [formGroup]="form">
  <div class="view-col-forms">
    <div fxLayout="row" fxLayoutGap="5px">
      <div fxFlex="50" fxLayout="column">
        <blg-select-branch-drop-down-v2
        [apiVisa]="apiVisa"
        [(branch)]="form.controls['deliveryBranch']"
        (branchSelected)="onDeliveryBranchSelected($event); updateMain.emit(form.value)"
        [branchGuids]="branchGuids"
        [controlName]="'Delivery Branch'"
      ></blg-select-branch-drop-down-v2>        
      <div *ngFor="let x of leftColControls; let i = index">
          <mat-form-field *ngIf="x.readonly;else input" appearance="outline">
            <mat-label>{{x.label}}</mat-label>
            <input matInput readonly [formControl]="form.controls[x.formControl]" autocomplete="off">
          </mat-form-field>
          <ng-template #input>
            <ng-container [ngSwitch]="x.type">
              <mat-form-field *ngSwitchCase="'text'" appearance="outline">
                <mat-label>{{x.label}}</mat-label>
                <input matInput [formControl]="form.controls[x.formControl]" (change)="updateMain.emit(form.value)" autocomplete="off" type="text">
                <mat-error>{{x.label}} is <strong>not valid</strong></mat-error>
              </mat-form-field>
              <mat-form-field *ngSwitchCase="'reqDelivery'" appearance="outline">
                <mat-label>{{x.label}}</mat-label>
                <mat-select [formControl]="form.controls[x.formControl]" (selectionChange)="updateMain.emit(form.value)">
                  <mat-option value="YES">YES</mat-option>
                  <mat-option value="NULL">NO</mat-option>
                </mat-select>
              </mat-form-field>
              <mat-form-field *ngSwitchCase="'regionCode'" appearance="outline">
                <mat-label>{{x.label}}</mat-label>
                <mat-select [formControl]="form.controls[x.formControl]" (selectionChange)="test($event.value)" [(ngModel)]="selectedRegionList">
                  <mat-option *ngFor="let reg of this.arrayRegion" [value]="reg">
                    {{reg.reg_code}} - {{reg.state}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <mat-form-field *ngSwitchCase="'number'" appearance = "outline">
                <mat-label>{{x.label}}</mat-label>
                <input matInput [formControl]="form.controls[x.formControl]" (change)="updateMain.emit(form.value)" autocomplete="off" type="number">
                <mat-error>{{x.label}} is <strong>not valid</strong></mat-error>
              </mat-form-field>
              <mat-form-field *ngSwitchCase="'text-area'" appearance = "outline">
                <mat-label>{{x.label}}</mat-label>
                <textarea matInput [formControl]="form.controls[x.formControl]" (change)="updateMain.emit(form.value)"></textarea>
                <mat-hint align="end">{{form.controls[x.formControl].value ? form.controls[x.formControl].value.length : 0}} characters</mat-hint>
              </mat-form-field>
              <mat-form-field *ngSwitchCase="'date'" appearance = "outline">
                <mat-label>{{x.label}}</mat-label>
                <input matInput [ngxMatDatetimePicker]="datepicker" [formControl]="form.controls[x.formControl]" autocomplete="off" readonly (dateChange)="updateMain.emit(form.value)" (click)="datepicker.open()">
                <mat-error>{{x.label}} is <strong>not valid</strong></mat-error>
                <mat-datepicker-toggle matSuffix [for]="datepicker" [disabled]="postingStatus"></mat-datepicker-toggle>
                <ngx-mat-datetime-picker
                #datepicker
                [touchUi]="true"
                [hideTime]="false"
              >
              </ngx-mat-datetime-picker>
              </mat-form-field>
            </ng-container>
          </ng-template>
        </div>
      </div>
      <div fxFlex="50" fxLayout="column">
        <blg-select-location-drop-down-v2 [branchSelectedGuid]="selectedDeliveryBranch" [apiVisa]="apiVisa"
        [(location)]="form.controls['deliveryLocation']" (locationSelected)="updateMain.emit(form.value); onDeliveryLocationSelected($event)" [controlName]="'Delivery Location'">
        </blg-select-location-drop-down-v2>         
        <div *ngFor="let x of rightColControls; let i = index">
          <mat-form-field *ngIf="x.readonly;else input" appearance="outline">
            <mat-label>{{x.label}}</mat-label>
            <input matInput readonly [formControl]="form.controls[x.formControl]" autocomplete="off">
          </mat-form-field>
          <ng-template #input>
            <ng-container [ngSwitch]="x.type">
              <mat-form-field *ngSwitchCase="'text'" appearance="outline">
                <mat-label>{{x.label}}</mat-label>
                <input matInput [formControl]="form.controls[x.formControl]" autocomplete="off" type="text" (change)="updateMain.emit(form.value)">
                <mat-error>{{x.label}} is <strong>not valid</strong></mat-error>
              </mat-form-field>
              <mat-form-field *ngSwitchCase="'number'" appearance = "outline">
                <mat-label>{{x.label}}</mat-label>
                <input matInput [formControl]="form.controls[x.formControl]" autocomplete="off" type="number" (change)="updateMain.emit(form.value)">
                <mat-error>{{x.label}} is <strong>not valid</strong></mat-error>
              </mat-form-field>
              <mat-form-field *ngSwitchCase="'text-area'" appearance = "outline">
                <mat-label>{{x.label}}</mat-label>
                <textarea matInput [formControl]="form.controls[x.formControl]" (change)="updateMain.emit(form.value)"></textarea>
                <mat-hint align="end">{{form.controls[x.formControl].value ? form.controls[x.formControl].value.length : 0}} characters</mat-hint>
              </mat-form-field>
              <mat-form-field *ngSwitchCase="'date'" appearance = "outline">
                <mat-label>{{x.label}}</mat-label>
                <input matInput [ngxMatDatetimePicker]="datepicker" [formControl]="form.controls[x.formControl]" autocomplete="off" readonly (dateChange)="updateMain.emit(form.value)" (click)="datepicker.open()">
                <mat-error>{{x.label}} is <strong>not valid</strong></mat-error>
                <mat-datepicker-toggle matSuffix [for]="datepicker" [disabled]="postingStatus"></mat-datepicker-toggle>
                <ngx-mat-datetime-picker
                #datepicker
                [touchUi]="true"
                [hideTime]="false"
              >
              </ngx-mat-datetime-picker>
              </mat-form-field>
            </ng-container>
          </ng-template>
        </div>
      </div>
    </div>
    <mat-form-field appearance = "outline">
      <mat-label>Delivery Remarks</mat-label>
      <textarea matInput [formControl]="form.controls['remarks']" (change)="updateMain.emit(form.value)"></textarea>
      <mat-hint align="end">{{form.controls['remarks']?.value ? form.controls['remarks']?.value.length : 0}} characters</mat-hint>
    </mat-form-field>
  </div>
</form>
